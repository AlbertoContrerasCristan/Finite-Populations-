theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
View(modelo)
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
TRUE ~ "Grid 4")),
Grid1_max = max1,
Grid1_min = min1,
Grid2_max = max2,
Grid2_min = min2,
Grid3_max = max3,
Grid3_min = min3,
Grid4_max = max4,
Grid4_min = min4,
)
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
TRUE ~ "Grid 4")),
Grid1_max = max1,
Grid1_min = min1,
Grid2_max = max2,
Grid2_min = min2,
Grid3_max = max3,
Grid3_min = min3,
Grid4_max = max4,
Grid4_min = min4
)
View(modelo)
modelo1 <- modelo %>%
gather("value", "variable", -c(r_n,Grid))
View(modelo1)
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value)) +
geom_point(aes(fig = Grid)) +
geom_line()
modelo %>% ggplot(aes(x = r_n, y = mean, group = variable)) +
geom_point(aes(  col = Runtime, shape = Grid), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_hline(yintercept = max1, col = 'black', size = 2, alpha = 0.7) +
geom_hline(yintercept = min1, col = 'black', size = 2, alpha = 0.7) +
geom_hline(yintercept = max2, col = 'gray30', size = 2, alpha = 0.7) +
geom_hline(yintercept = min2, col = 'gray30', size = 2, alpha = 0.7) +
geom_hline(yintercept = max3, col = 'gray50', size = 2, alpha = 0.7) +
geom_hline(yintercept = min3, col = 'gray50', size = 2, alpha = 0.7) +
geom_hline(yintercept = max4, col = 'gray70', size = 2, alpha = 0.7) +
geom_hline(yintercept = min4, col = 'gray70', size = 2, alpha = 0.7) +
geom_line(col = "#79BC42") +
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 60000,
by = 1500)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(fig = Grid)) +
geom_line()
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,runtime,Grid))
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
geom_line()
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
TRUE ~ "Grid 4")),
Max = case_when(r_n <= 5000 ~ max1,
r_n > 5000 & r_n <= 10000 ~ max2,
r_n > 10000 & r_n <= 30000 ~ max3,
TRUE ~ max4),
Min = case_when(r_n <= 5000 ~ min1,
r_n > 5000 & r_n <= 10000 ~ min2,
r_n > 10000 & r_n <= 30000 ~ min3,
TRUE ~ min4))
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid))
View(modelo1)
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid,Max,Min))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
geom_line(aes(y = Max))+
geom_line(aes(y = Min))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
gem_line() +
geom_line(aes(y = Max,group = Grid))+
geom_line(aes(y = Min, group = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
geom_line() +
geom_line(aes(y = Max,group = Grid))+
geom_line(aes(y = Min, group = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
geom_line() +
geom_line(aes(y = Max,group = Grid, col = Grid))+
geom_line(aes(y = Min, group = Grid, col = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
geom_line() +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime)) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line() +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable, col = Grid)) +
geom_point(aes(shape = Grid, col = Runtime)) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line() +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable, color = Grid)) +
geom_point(aes(shape = Grid, col = Runtime)) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line() +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 60000,
by = 1500)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 60000,
by = 1500)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
library(tidyverse)
grid1 <- read_csv("~/Finite-Populations-/graph/r_n1.csv")
grid2 <- read_csv("~/Finite-Populations-/graph/r_n2.csv")
grid3 <- read_csv("~/Finite-Populations-/graph/r_n3.csv")
grid4 <- read_csv("~/Finite-Populations-/graph/r_n4.csv")
grid5 <- read_csv("~/Finite-Populations-/graph/r_n5.csv")
media1 <- read_csv("~/Finite-Populations-/graph/mean1.csv")
media2 <- read_csv("~/Finite-Populations-/graph/mean2.csv")
media3 <- read_csv("~/Finite-Populations-/graph/mean3.csv")
media4 <- read_csv("~/Finite-Populations-/graph/mean4.csv")
media5 <- read_csv("~/Finite-Populations-/graph/mean5.csv")
tiempo1 <- read_csv("~/Finite-Populations-/graph/runtime1.csv")
tiempo2 <- read_csv("~/Finite-Populations-/graph/runtime2.csv")
tiempo3 <- read_csv("~/Finite-Populations-/graph/runtime3.csv")
tiempo4 <- read_csv("~/Finite-Populations-/graph/runtime4.csv")
tiempo5 <- read_csv("~/Finite-Populations-/graph/runtime5.csv")
full_grid <- bind_rows(
bind_rows(
bind_rows(
bind_rows(grid1,grid2),grid3),grid4),grid5)
full_mean <- bind_rows(
bind_rows(
bind_rows(
bind_rows(media1,media2),media3),media4),media5)
full_time <- bind_rows(
bind_rows(
bind_rows(
bind_rows(tiempo1,tiempo2),tiempo3),tiempo4),tiempo5)
max5 <- max(media5)
min5 <- min(media5)
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
r_n > 30000 & r_n <= 60000 ~ "Grid 4",
TRUE ~ "Grid 5")),
Max = case_when(r_n <= 5000 ~ max1,
r_n > 5000 & r_n <= 10000 ~ max2,
r_n > 10000 & r_n <= 30000 ~ max3,
r_n > 30000 & r_n >= 60000 ~ max4
TRUE ~ max5),
Min = case_when(r_n <= 5000 ~ min1,
r_n > 5000 & r_n <= 10000 ~ min2,
r_n > 10000 & r_n <= 30000 ~ min3,
r_n > 30000 & r_n <= 60000 ~ min4
TRUE ~ min5))
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
r_n > 30000 & r_n <= 60000 ~ "Grid 4",
TRUE ~ "Grid 5")),
Max = case_when(r_n <= 5000 ~ max1,
r_n > 5000 & r_n <= 10000 ~ max2,
r_n > 10000 & r_n <= 30000 ~ max3,
r_n > 30000 & r_n >= 60000 ~ max4,
TRUE ~ max5),
Min = case_when(r_n <= 5000 ~ min1,
r_n > 5000 & r_n <= 10000 ~ min2,
r_n > 10000 & r_n <= 30000 ~ min3,
r_n > 30000 & r_n <= 60000 ~ min4,
TRUE ~ min5))
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid,Max,Min))
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid,Max,Min))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 60000,
by = 1500)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo <- data_frame(r_n = full_grid$r_n,
mean = full_mean$mean,
Runtime = full_time$runtime) %>%
mutate( Grid = as.factor(case_when( r_n <= 5000 ~ "Grid 1",
r_n > 5000 & r_n <= 10000 ~ "Grid 2",
r_n > 10000 & r_n <= 30000 ~ "Grid 3",
r_n > 30000 & r_n <= 60000 ~ "Grid 4",
TRUE ~ "Grid 5")),
Max = case_when(r_n <= 5000 ~ max1,
r_n > 5000 & r_n <= 10000 ~ max2,
r_n > 10000 & r_n <= 30000 ~ max3,
r_n > 30000 & r_n <= 60000 ~ max4,
TRUE ~ max5),
Min = case_when(r_n <= 5000 ~ min1,
r_n > 5000 & r_n <= 10000 ~ min2,
r_n > 10000 & r_n <= 30000 ~ min3,
r_n > 30000 & r_n <= 60000 ~ min4,
TRUE ~ min5))
modelo1 <- modelo %>%
gather("variable", "value", -c(r_n,Runtime,Grid,Max,Min))
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, col = Runtime), size = 3) +
scale_shape_manual(values=c(16, 15, 17,18,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, fill = Runtime), size = 3) +
scale_shape_manual(values=c(21, 22, 23,24,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=5000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, fill = Runtime), size = 3) +
scale_shape_manual(values=c(21, 22, 23,24,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=6000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, fill = Runtime), size = 3) +
scale_shape_manual(values=c(21, 22, 23,24,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=7000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5)) +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
modelo1 %>% ggplot(aes(x = r_n, y = value, group = variable)) +
geom_point(aes(shape = Grid, fill = Runtime), size = 3) +
scale_shape_manual(values=c(21, 22, 23,24,25))+
geom_vline(xintercept = 1600, show.legend = 'R-N TLC', col = "purple", size = 1)+
geom_text(aes(x=7000,
label= paste("R-N CLT ~",1600),
y=1.5628),
text=element_text(size=5),
family = 'Arial') +
geom_line(col = "#79BC42") +
geom_line(aes(y = Max,group = Grid, linetype = Grid))+
geom_line(aes(y = Min, group = Grid,  linetype = Grid)) +
scale_linetype_manual(values = c("solid", "dashed", "dotted", "twodash","dotdash"))+
scale_y_continuous(breaks = signif(seq(from=min1,
to = max1,
length.out = 10),5))+
scale_x_continuous(breaks = seq(from = 0,
to = 90000,
by = 2000)) +
theme_pro() +
theme(
axis.text.x = element_text(angle = 60)
) +
labs(title = "Posterior Total Mean",
subtitle = "N = 100,000",
caption = "Units in Thousands",
x = "R - n",
y = "Total Population Mean")
